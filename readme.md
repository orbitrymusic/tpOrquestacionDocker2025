 Auth_Service: Gu铆a de Arranque y TroubleshootingEste documento es la gu铆a oficial para levantar el entorno de desarrollo del microservicio de autenticaci贸n.Utilizamos Docker Compose para orquestar la Base de Datos (MongoDB) y el cliente visual, mientras que el backend de Node.js se ejecuta localmente para una f谩cil depuraci贸n (npm run dev).锔 1. Requisitos y Configuraci贸n Inicial1.1. Dependencias NecesariasAseg煤rate de tener instalados:Docker Desktop (o Docker Engine).Node.js y npm (o yarn).1.2. Configuraci贸n Cr铆tica del .envPara que tu aplicaci贸n local (npm run dev) pueda conectarse al contenedor de MongoDB, la variable MONGODB_URI debe usar localhost.Asegura que tu archivo .env contenga:Fragmento de c贸digo# Configuraci贸n de la Base de Datos
MONGODB_URI=mongodb://localhost:27017/authdb

# JWT (隆NO DEJAR VACO!)
JWT_SECRET=tu-cadena-secreta-larga-y-completamente-aleatoria
JWT_EXPIRATION=1h 
1.3. Instalar Dependencias del ProyectoEjecuta este comando una sola vez en la ra铆z del proyecto:Bashnpm install
讹 2. Flujo de ArranqueSigue estos dos pasos en orden:Paso 1: Levantar los Servicios de Docker (DB y Cliente)Este comando inicia los servicios esenciales definidos en el docker-compose.yml:Bashdocker-compose up -d mongo-server mongo-client
TareaVerificaci贸nEstado:Confirma que los contenedores est茅n en estado Up: docker-compose psAcceso DB:Abre el cliente Mongo Express en: http://localhost:8082Paso 2: Arrancar el Backend (API de Node.js)Inicia tu aplicaci贸n Node.js en modo desarrollo:Bashnpm run dev
La API ahora es accesible en: http://localhost:3001.3. Gu铆a de Troubleshooting (Errores Comunes)Documentamos los problemas m谩s frecuentes encontrados y sus soluciones definitivas:3.1. Problemas de Conexi贸n y HostErrorCausa PrincipalSoluci贸ngetaddrinfo ENOTFOUND mongo-serverLa API local us贸 el nombre interno de Docker.Corregir el .env para usar localhost (Ver Secci贸n 1.2).ECONNREFUSED 127.0.0.1:27017MongoDB no est谩 listo o el puerto no est谩 expuesto.Asegurar que el contenedor de Mongo est茅 Up y que el docker-compose.yml contenga: ports: - "27017:27017".3.2. Contenedor Reiniciando (Restarting)Si mongo-server se reinicia continuamente, es casi seguro un problema de datos o permisos corruptos en el volumen.Det茅n y elimina el contenedor y su volumen de datos asociado:Bashdocker-compose down -v
Vuelve a ejecutar el Paso 1 del flujo de arranque para iniciar la DB con un estado limpio.3.3. Conflicto de Nombres o PuertosSi recibes errores como Conflict. The container name "/..." is already in use o address already in use:Para Contenedores: Elimina el contenedor que est谩 causando el conflicto forzadamente:Bashdocker rm -f <nombre-del-contenedor>
Para Puertos: Alg煤n otro programa est谩 usando el puerto. Det茅n el proceso conflictivo o cambia el puerto en el docker-compose.yml (ej., usa 8083:8082 en lugar de 8082:8082).4. Detener y Limpiar el EntornoPara finalizar la sesi贸n de trabajo y liberar recursos:ComandoFunci贸ndocker-compose stopDetiene los contenedores, pero los mantiene guardados.docker-compose downDetiene y elimina los contenedores y redes (pr谩ctica recomendada al finalizar).
